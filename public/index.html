<!DOCTYPE html>
<html>

  <head>

    <meta charset="utf-8">
    <title>BⱯBEL RËVOLUㅏION</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://apis.google.com/js/api.js"></script>

    <link rel="icon" href="/img/icone-babel.png" type="image/png">
    
    <link rel="stylesheet" href="/style/style.css">
    <link rel="stylesheet" href="/style/index.css">
  </head>
  <body>

      <header>
        <div class="logo" onclick="window.location.href = window.location.href">
          <img src="\img\logoV2.png" alt="image" title="Revenir au menu principal">
        </div> 
      </header>

      <select i18n-switch class="locale-switch">
        <option value="en">English</option>
        <option value="fr">Français</option>
      </select>

    <div id="container">
        <div id="title_presentation" i18n-key="title_presentation">
        </div>
      </div>
      <div id="content">
        <div id="text_presentation" i18n-key="text_presentation">
        </div>
            <h1 id="session_public" i18n-key="session_public"></h1>
            <div id="public_sessions">
                <div id="session_template" onclick="window.location.href = '/session/67?intro'" style="cursor:pointer">
                    <div class="image">
                        <img src="/img/graphe1.png" alt="graph" class="graph">
                    </div>
                </div>
            </div>

            <h1 id="sessions_completed" i18n-key="completed_sessions">=</h1>
            <div id="completed_sessions">
                <!-- TODO : Populate with completed sessions -->
            </div>
        </div>
  </body>
  <script src="/src/i18n.js"></script>
<script type="module">
    const sessionTemplate = document.querySelector("div#session_template");
    const completedSessionsDiv = document.querySelector("div#completed_sessions");
    // Get all the sessions that the current user is allowed to see and display them
    fetch('/session/get-visible-sessions', {
        method: 'get',
    }).then(res => {
        let sessions = res.json();
        console.log(sessions);
        // Create the HTML element for each session
        for (let session in sessions){
            let newSession = sessionTemplate.cloneNode(true);
            newSession.querySelector('.session_title').textContent = session.title;
            newSession.setAttribute('id', session.id);
            newSession.setAttributes('href', '/completed/' + session.id);
            console.log(newSession);
            completedSessionsDiv.appendChild(newSession);
        }
    }).catch(error => {
        console.error('Error getting sessions : ', error);
    });
</script>
</html>